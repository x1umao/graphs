<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link rel="icon" type="image/png" href="images/favicon-small.png" sizes="16x16">
    <link rel="icon" type="image/png" href="images/favicon-large.png" sizes="32x32">
    <title>Graphs DB</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="css/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <script src="https://d3js.org/d3.v4.min.js"></script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/echarts@5/dist/echarts.min.js"></script>
</head>

<body class="person-bg">
<div class="container">
    <div class="row">
        <div class="col-12 col-lg-8">
            <div class="row pt-0 pb-2 pt-md-4">
                <div class="col-12 col-md-4 col-lg-3 my-auto">
                    <div class="logo py-5 py-md-0 ">
                        <a href="index.html">
                            <img src="images/graphs-logo.svg" class="mx-auto mx-md-0">
                        </a>
                    </div>
                </div>
                <div class="col-12 col-md-8 col-lg-9">
                    <div class="form-group form-search mb-0 mr-5 pr-3">
                        <span class="fa fa-search form-icon"></span>
                        <input type="text" class="form-control" placeholder="Search person, article, journal...">
                    </div>
                    <button class="btn btn-dark btn-sqr search-filter"><a href="#" data-toggle="modal"
                                                                          data-target="#FilterModal"><i
                            class="fa fa-sliders-h btn-icon"></i></a></button>
                </div>
            </div>
        </div>
    </div>
    <div class="row pb-5 pb-md-4">
        <div class="col-12 col-lg-8">
            <div class="card-m card-person">
                <div class="row">
                    <div class="col-2 col-lg-1">
                        <span class="fa fa-user-circle card-icon"></span>
                    </div>
                    <div class="col-10 col-lg-11">
                        <h4 class="pb-3" th:text="${pDetailVO.person.name}">Edson C. Tandoc Jr.</h4>
                        <p th:text="${pDetailVO.person.gender}">Male</p>
                        <p class="ml-5"><b>Articles</b></p>
                        <p class="ml-3" th:text="${pDetailVO.counter}">Nil</p>
                    </div>
                </div>
            </div>
            <div class="card-m card-graph">
                <button class="btn btn-dark btn-sqr graph-filter"><a href="#" data-toggle="modal"
                                                                     data-target="#graphModal"><i
                        class="fa fa-sliders-h btn-icon"></i></a></button>
                <!--                <img src="https://via.placeholder.com/500" width="100%">-->
                <div id="graphContainer" style="width: 100%;height:600px"></div>
            </div>
        </div>
        <div class="col-12 col-lg-4">
            <div class="row">
                <div class="col-12 col-md-6 col-lg-12">
                    <div class="card-m">
                        <h5>Articles</h5>
                        <div id="column-chart-person" class="pt-4"></div>
                    </div>
                </div>
                <div class="col-12 col-md-6 col-lg-12">
                    <div class="card-m">
                        <h5>Related Persons</h5>
                        <div th:each="p:${pDetailVO.relatedPerson}">
                            <a th:href="|person-detail?name=${p.name}|" class="card-hover">
                                <div class="card-s card-person card-s-person">
                                    <span class="fa fa-user-circle card-icon"></span>
                                    <div class="card-s-info ml-5">
                                        <h6 class="mb-1" th:text="${p.name}">Patrick Ferrucci</h6>
                                        <p th:text="${p.gender}">Male</p>
                                        <p class="ml-4"><b>Articles</b></p>
                                        <p class="ml-2" th:text="${p.counter}">121</p>
                                    </div>
                                </div>
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Filter Modal-->
<div class="modal fade" id="FilterModal" tabindex="-1" role="dialog" aria-labelledby="ModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h6 class="modal-title" id="exampleModalLabel">Set Filters</h6>
                <button class="close" type="button" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">×</span>
                </button>
            </div>
            <div class="modal-body">
                <form>
                    <div class="row">
                        <div class="col-12">
                            <h6 class="pb-3">Publication Year</h6>
                        </div>
                        <div class="col-6">
                            <input type="text" class="form-control mb-3" id="pubFilterFrom" name="pubFilterFrom"
                                   placeholder="from">
                        </div>
                        <div class="col-6">
                            <input type="text" class="form-control mb-3" id="pubFilterTo" name="pubFilterTo"
                                   placeholder="to">
                        </div>
                        <div class="col-12">
                            <h6 class="pb-3">Category</h6>
                            <div class="btn-group" data-toggle="buttons">
                                    			<span class="button-checkbox">
											        <button type="button" class="btn" data-color="dark">Person</button>
											        <input type="checkbox" style="display: none;"/>
											    </span>
                                <span class="button-checkbox">
											        <button type="button" class="btn ml-2"
                                                            data-color="dark">Article</button>
											        <input type="checkbox" style="display: none;"/>
											    </span>
                                <span class="button-checkbox">
											        <button type="button" class="btn ml-2"
                                                            data-color="dark">Journal</button>
											        <input type="checkbox" style="display: none;"/>
											    </span>
                            </div>
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" type="button" data-dismiss="modal">Cancel</button>
                <button class="btn btn-dark" type="button" data-dismiss="modal">Apply Filter</button>
            </div>
        </div>
    </div>
</div>

<!-- Graph Filter Modal-->
<div class="modal fade" id="graphModal" tabindex="-1" role="dialog" aria-labelledby="ModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h6 class="modal-title" id="exampleModalLabel">Set Graph Filters</h6>
                <button class="close" type="button" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">×</span>
                </button>
            </div>
            <div class="modal-body">
                <form>
                    <div class="row">
                        <div class="col-12">
                            <h6 class="pb-3">Publication Year</h6>
                        </div>
                        <div class="col-6">
                            <input type="text" class="form-control mb-3" id="pubFilterFrom" name="pubFilterFrom"
                                   placeholder="from">
                        </div>
                        <div class="col-6">
                            <input type="text" class="form-control mb-3" id="pubFilterTo" name="pubFilterTo"
                                   placeholder="to">
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" type="button" data-dismiss="modal">Cancel</button>
                <button class="btn btn-dark" type="button" data-dismiss="modal">Apply Filter</button>
            </div>
        </div>
    </div>
</div>
<script src="js/column-chart-person.js"></script>
<script th:inline="javascript">
    const graph = /*[[${pDetailVO.echartsVO}]]*/ "??";
    const dom = document.getElementById("graphContainer");
    const myChart = echarts.init(dom);
    const app = {};
    let option;
    const colorTable = ['#FF5733', '#27AE60', '#884EA0'];
    // myChart.showLoading();
    graph.nodes.forEach(function (node) {
        node.symbolSize = 50;
    });
    graph.nodes.forEach(function (node) {
        node.category = parseInt(node.category);
    })
    option = {
        title: {
            text: ' ',
            subtext: 'Default layout',
            top: 'bottom',
            left: 'right'
        },
        tooltip: {},
        legend: [{
            // selectedMode: 'single',
            data: graph.category.map(function (a) {
                return a.name;
            })
        }],
        series: [
            {
                name: 'test',
                type: 'graph',
                layout: 'force',
                data: graph.nodes,
                links: graph.links,
                categories: graph.category,
                roam: true,
                label: {
                    show: true
                },
                force: {
                    repulsion: 1000
                },
                emphasis: {
                    focus: 'adjacency',
                    lineStyle: {
                        width: 10
                    }
                }
            }
        ],
        color: colorTable
    };

    myChart.setOption(option);

    if (option && typeof option === 'object') {
        myChart.setOption(option);
    }

</script>
</body>
</html>
